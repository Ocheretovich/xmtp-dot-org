---
sidebar_label: Read Receipt
sidebar_position: 7
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# Read Receipt Content Type

![Status](https://img.shields.io/badge/Content_type_status-Standards--track-yellow) ![Status](https://img.shields.io/badge/Reference_implementation_status-Beta-yellow)

A read receipt is a `timestamp` that indicates when a message was read. It is sent as a message and can be used to calculate the time since the last message was read.

:::tip Open for feedback

You are welcome to provide feedback by commenting on the [Read Receipts Content Type XIP](https://github.com/orgs/xmtp/discussions/43) Proposal.

:::

### Configure content type

<Tabs groupId="sdk-langs">
<TabItem value="js" label="JavaScript"  attributes={{className: "js_tab"}}>

```bash
npm i @xmtp/content-type-read-receipt
```

Import and register

```tsx
import {
  ContentTypeReadReceipt,
  ReadReceiptCodec,
} from "@xmtp/content-type-read-receipt";
// Create the XMTP client
const xmtp = await Client.create(signer, { env: "dev" });
xmtp.registerCodec(new ReadReceiptCodec());
```

</TabItem>
<TabItem value="react" label="React"  attributes={{className: "react_tab"}}>

The React SDK supports all current standards-track content types, but only text messages are enabled out of the box. Adding support for other standards-track content types requires a bit of configuration.

```jsx
import {
  XMTPProvider,
  readReceiptContentTypeConfig,
} from "@xmtp/react-sdk";

const contentTypeConfigs = [
  readReceiptContentTypeConfig,
  // other content type configs...
];

createRoot(document.getElementById("root") as HTMLElement).render(
  <StrictMode>
    <XMTPProvider contentTypeConfigs={contentTypeConfigs}>
      <App />
    </XMTPProvider>
  </StrictMode>,
);
```

</TabItem>
<TabItem value="kotlin" label="Kotlin"  attributes={{className: "kotlin_tab"}}>

```kotlin
Client.register(codec = ReadReceiptCodec())
```

</TabItem>
<TabItem value="dart" label="Dart"  attributes={{className: "dart_tab"}}>

Remote Attachments haven't been implemented yet.

</TabItem>
<TabItem value="rn" label="React Native"  attributes={{className: "rn_tab"}}>

Read Receipts haven't been implemented yet.

</TabItem></Tabs>

### Sending a Read Receipt

- `messageId`: The message id of the message that was read
- `timestamp`: The timestamp the read receipt was sent, in ISO 8601 format

<Tabs groupId="sdk-langs">
<TabItem value="js" label="JavaScript"  attributes={{className: "js_tab"}}>

```tsx
await conversation.messages.send(
  {
    timestamp: new Date().toISOString(),
  },
  ContentTypeReadReceipt,
);
```

</TabItem>
<TabItem value="react" label="React"  attributes={{className: "react_tab"}}>

```jsx
import { useSendMessage } from "@xmtp/react-sdk";
import { ContentTypeReadReceipt } from "@xmtp/content-type-read-receipt";

const sendMessage = useSendMessage();
const readReceiptContent = { timestamp: new Date().toISOString() };

sendMessage(conversation, readReceiptContent, ContentTypeReadReceipt);
```

</TabItem>
<TabItem value="kotlin" label="Kotlin"  attributes={{className: "kotlin_tab"}}>

```kotlin
val readReceipt = ReadReceipt(timestamp = "2019-09-26T07:58:30.996+0200")
conversation.send(
    content = readReceipt,
    options = SendOptions(contentType = ContentTypeReadReceipt),
)
```

</TabItem></Tabs>

### Receiving a Read Receipt

Here's how you can receive a reply:

<Tabs groupId="sdk-langs">
<TabItem value="js" label="JavaScript"  attributes={{className: "js_tab"}}>

```tsx
if (message.contentType.sameAs(ContentTypeReadReceipt)) {
  // We've got a reply.
  const timestamp = message.content.timestamp;
}
```

</TabItem>
<TabItem value="react" label="React"  attributes={{className: "react_tab"}}>

```jsx
import { ContentTypeReadReceipt } from "@xmtp/content-type-read-receipt";

if (ContentTypeReadReceipt.sameAs(message.contentType)) {
  // The message is a read receipt
  const readReceiptContent = message.content;
  const timestamp = readReceiptContent.timestamp;
}
```

**getReadReceipt**

The getReadReceipt function retrieves the read receipt from a cached conversation. It takes a CachedConversation object as a parameter and returns the read receipt date, or undefined if the conversation has no read receipt.

```jsx
import { getReadReceipt } from "@xmtp/react-sdk";

const readReceiptDate = getReadReceipt(conversation);
```

**hasReadReceipt**

The hasReadReceipt function checks if a cached conversation has a read receipt. It takes a CachedConversation object as a parameter and returns true if the conversation has a read receipt, false otherwise.

```jsx
import { hasReadReceipt } from "@xmtp/react-sdk";

const hasReceipt = hasReadReceipt(conversation);
```

</TabItem>
<TabItem value="kotlin" label="Kotlin"  attributes={{className: "kotlin_tab"}}>

```kotlin
val message: DecodedMessage = conversation.messages().first()
if (message.encodedContent.type == ContentTypeReadReceipt) {
    // The message is a ReadReceipt
    val readReceipt: ReadReceipt? = message.content()
    if (readReceipt != null) {
      println("Message read at: ${readReceipt.timestamp}")
    }
}
```

</TabItem></Tabs>

### Displaying the Read Receipt

A read receipt timestamp should be not display but instead used to calculate the time since the last message was read. While iterating through messages you can be sure that the last message was read at the timestamp of the read receipt if the string if the date is lower.

<Tabs groupId="sdk-langs">
<TabItem value="js" label="JavaScript"  attributes={{className: "js_tab"}}>

```jsx
function checkReadMessages(messages, readReceipt) {
  return messages.map((message) => {
    return {
      ...message,
      isRead: message.timestamp <= readTimestamp,
    };
  });
}
```

</TabItem></Tabs>
